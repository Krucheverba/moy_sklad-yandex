# –û–±—Ä–∞—â–µ–Ω–∏–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –Ø–Ω–¥–µ–∫—Å.–ú–∞—Ä–∫–µ—Ç

## üìß –ö—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å:
https://yandex.ru/support/market-tech/

–ò–ª–∏ —á–µ—Ä–µ–∑ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç: https://partner.market.yandex.ru/ ‚Üí "–ü–æ–º–æ—â—å" ‚Üí "–ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É"

---

## üìù –¢–µ–º–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è:
```
–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å OAuth —Ç–æ–∫–µ–Ω –¥–ª—è Partner REST API?
```

---

## üìÑ –¢–µ–∫—Å—Ç –æ–±—Ä–∞—â–µ–Ω–∏—è:

```
–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!

–ú–Ω–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º OAuth —Ç–æ–∫–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Partner REST API (https://api.partner.market.yandex.ru).

–Ø —Å–æ–∑–¥–∞–ª —Ç–æ–∫–µ–Ω –≤ —Ä–∞–∑–¥–µ–ª–µ "–Ø.–ü—Ä–æ–¥–∞–≤–µ—Ü" ‚Üí "API" –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ, –Ω–æ –ø–æ–ª—É—á–∏–ª —Ç–æ–∫–µ–Ω —Ñ–æ—Ä–º–∞—Ç–∞:
ACMA:client_id:client_secret

–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Ç–æ–∫–µ–Ω –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Partner API –ø–æ–ª—É—á–∞—é –æ—à–∏–±–∫–∏:
- –° –∑–∞–≥–æ–ª–æ–≤–∫–æ–º "OAuth ACMA:xxx:xxx" ‚Üí 401 "Authorization header has invalid syntax"
- –° –∑–∞–≥–æ–ª–æ–≤–∫–æ–º "Bearer ACMA:xxx:xxx" ‚Üí 403 "OAuth token is invalid"
- –° Basic Auth ‚Üí 401 "OAuth credentials are not specified"

–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ - –Ω–∏ –æ–¥–∏–Ω –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

–í–æ–ø—Ä–æ—Å—ã:
1. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω —Ñ–æ—Ä–º–∞—Ç–∞ ACMA:xxx:xxx –¥–ª—è Partner REST API?
2. –ò–ª–∏ –Ω—É–∂–µ–Ω –¥—Ä—É–≥–æ–π —Ç–∏–ø —Ç–æ–∫–µ–Ω–∞? –ï—Å–ª–∏ –¥–∞, —Ç–æ –∫–∞–∫ –µ–≥–æ –ø–æ–ª—É—á–∏—Ç—å?
3. –ö–∞–∫–æ–π —Ñ–æ—Ä–º–∞—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ Authorization –Ω—É–∂–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Partner API?

–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ—ë–º –º–∞–≥–∞–∑–∏–Ω–µ:
- Campaign ID: 128441417
- –ú–æ–¥–µ–ª—å: FBS
- –†–µ–≥–∏–æ–Ω: –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥

–¶–µ–ª—å: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤ —Å —Å–∏—Å—Ç–µ–º–æ–π —É—á—ë—Ç–∞ –ú–æ–π–°–∫–ª–∞–¥ —á–µ—Ä–µ–∑ Partner API.
–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–µ—Ç–æ–¥—ã API:
- GET /campaigns - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–∞–º–ø–∞–Ω–∏–π
- POST /campaigns/{campaignId}/offer-mapping-entries/suggestions - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ webhook –¥–ª—è –∑–∞–∫–∞–∑–æ–≤

–ë—É–¥—É –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ –ø–æ–º–æ—â—å –≤ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –¥–ª—è REST API.

–°–ø–∞—Å–∏–±–æ!
```

---

## üîç –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–µ—Å–ª–∏ –ø–æ–ø—Ä–æ—Å—è—Ç):

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–π —è–∑—ã–∫: Node.js
- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞: axios
- Endpoint: https://api.partner.market.yandex.ru/campaigns
- –ú–µ—Ç–æ–¥: GET
- –ó–∞–≥–æ–ª–æ–≤–∫–∏: Authorization: OAuth {token}, Accept: application/json

**–ß—Ç–æ —É–∂–µ –ø—Ä–æ–±–æ–≤–∞–ª–∏:**
1. OAuth —Å –ø–æ–ª–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º ACMA:xxx:xxx
2. OAuth —Ç–æ–ª—å–∫–æ —Å client_id
3. OAuth —Å client_id:client_secret
4. Bearer —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏
5. Basic Auth —Å client_id:client_secret –≤ base64
6. –ë–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

–í—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –æ—à–∏–±–∫–∏ 401 –∏–ª–∏ 403.

---

## ‚è±Ô∏è –û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞:
–û–±—ã—á–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ç–≤–µ—á–∞–µ—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 1-3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π.

---

## üìå –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞:

1. –ï—Å–ª–∏ –¥–∞–¥—É—Ç –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω:
   - –û–±–Ω–æ–≤–∏—Ç–µ YANDEX_TOKEN –≤ —Ñ–∞–π–ª–µ .env
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ: `node diagnose-yandex-token.js`
   - –ï—Å–ª–∏ —Ç–µ—Å—Ç –ø—Ä–æ—à—ë–ª, –∑–∞–ø—É—Å—Ç–∏—Ç–µ: `node generate-mapping.js`

2. –ï—Å–ª–∏ —Å–∫–∞–∂—É—Ç, —á—Ç–æ —Ç–æ–∫–µ–Ω ACMA –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π:
   - –ü–æ–ø—Ä–æ—Å–∏—Ç–µ –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –Ω–∞ Node.js –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
   - –°–ø—Ä–æ—Å–∏—Ç–µ, –∫–∞–∫–æ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ Authorization –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

3. –ï—Å–ª–∏ —Å–∫–∞–∂—É—Ç, —á—Ç–æ Partner API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:
   - –°–ø—Ä–æ—Å–∏—Ç–µ –ø—Ä–æ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤
   - –£—Ç–æ—á–Ω–∏—Ç–µ, –º–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å FTP –≤—ã–≥—Ä—É–∑–∫—É –∏–ª–∏ –¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã

---

## üéØ –ü–æ–∫–∞ –∂–¥—ë—Ç–µ –æ—Ç–≤–µ—Ç:

–ú–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å –º–∞–ø–ø–∏–Ω–≥ —Ç–æ–≤–∞—Ä–æ–≤ –≤—Ä—É—á–Ω—É—é –∏ –Ω–∞—á–∞—Ç—å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∑–∞–∫–∞–∑—ã:

```bash
node create-manual-mapping.js
```

Webhook –¥–ª—è –∑–∞–∫–∞–∑–æ–≤ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –ø—Ä–æ–±–ª–µ–º!
